<script>

    document.getElementById('categorySelect').addEventListener('change', function() {
        const selectedCategory = this.value;
        
        const subcategorySelect = document.getElementById('subcategorySelect');
    
        // Clear existing options
        subcategorySelect.innerHTML = '<option value="" disabled selected>Select Sub-Category</option>';
        
        // Fetch subcategories from the backend
        fetch(`getcategories/${selectedCategory}/`)
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json(); // Parse JSON from response
          })
          .then(data => {
            // Populate subcategory dropdown
            console.log(data.sub_categories);
            
            data.subcategories.forEach(subcategory => {
                console.log(subcategory);
                
              const option = document.createElement('option');
              option.value = subcategory.id; // Use subcategory id for value
              option.textContent = subcategory.name; // Use subcategory name for display
              subcategorySelect.appendChild(option);
            });
          })
          .catch(error => {
            console.error('Error fetching subcategories:', error);
          });
      });
    
    
    
    
    
    
    
    
    
      CKEDITOR.replace('editor');
      const uploadImagesInput = document.getElementById("uploadImages");
      const imageStack = document.getElementById("imageStack");
    
      // Handle image upload
      uploadImagesInput.addEventListener("change", (event) => {
        const files = Array.from(event.target.files);
    
        files.forEach((file) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const imageDiv = document.createElement("div");
            imageDiv.className = "relative w-24 h-24 flex-shrink-0";
    
            const img = document.createElement("img");
            img.src = e.target.result;
            img.alt = file.name;
            img.className = "w-full h-full object-cover rounded-lg";
    
            const deleteButton = document.createElement("button");
            deleteButton.className = "absolute top-1 right-1 bg-red-500 text-white text-xs rounded-full p-1 opacity-0 hover:opacity-100 transition-opacity";
            deleteButton.innerText = "âœ•";
    
            // Delete functionality
            deleteButton.addEventListener("click", () => {
              imageDiv.remove();
            });
    
            imageDiv.addEventListener("mouseenter", () => {
              deleteButton.style.opacity = 1;
            });
            imageDiv.addEventListener("mouseleave", () => {
              deleteButton.style.opacity = 0;
            });
    
            imageDiv.appendChild(img);
            imageDiv.appendChild(deleteButton);
            imageStack.appendChild(imageDiv);
          };
          reader.readAsDataURL(file);
        });
    
        // Clear input value to allow re-uploading the same file if needed
        event.target.value = "";
      });
    </script>